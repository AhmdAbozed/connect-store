function f(){const a=new URLSearchParams(window.location.search),o=a.get("name"),e=a.get("category_id"),t=a.get("specifications");if(o){const n=document.querySelector('input[name="categoryName"]');n&&(n.value=o)}if(e){const n=document.querySelector('select[name="category"]');if(n){n.value=e;const c=new Event("change",{bubbles:!0});n.dispatchEvent(c)}}t&&(console.log(t),JSON.parse(t).forEach(c=>{d(c)}))}const y=a=>{const o=async(e,t)=>{console.log("er"),e.preventDefault();const n=e.target,c=n.querySelector(".result"),i=new FormData,s=n.querySelector(".submit-btn");s.disabled=!0,s.innerHTML="Submitting...",c.classList.add("hidden");try{if(i.append("Name",n.elements.categoryName.value),n.elements.categoryImage.files[0]&&i.append("Image",n.elements.categoryImage.files[0]),i.append("Updating_id",n.elements.UpdatingId.value),t==="subcategory"){i.append("Category_id",n.elements.category.value);const m=Array.from(document.querySelectorAll(".category-specification")).map(g=>g.children[0].value);i.append("Specifications",JSON.stringify(m))}const r={method:"POST",headers:{"Access-Control-Allow-Credentials":"true",Accept:"multipart/form-data"},credentials:"include",body:i};e.target.reset();const p=location.protocol+"//"+location.host+"/_api/"+t,l=await fetch(p,r);s.innerHTML="Submit",s.disabled=!1,c.classList.remove("hidden"),l.status===200?c.children[0].innerHTML=t+" Added.":c.children[0].innerHTML="Failed to add "+t+". Code: "+l.status}catch(r){throw s.innerHTML="Submit",s.disabled=!1,c.classList.remove("hidden"),console.log(r),c.children[0].innerHTML="Failed to add "+t+". Unknown Error",r}};document.getElementById("new-category-panel").addEventListener("submit",e=>o(e,u?"subcategory":"category"))},d=function(a){const o=document.createElement("div");o.className="flex space-x-4 items-center category-specification";const e=document.createElement("input");e.type="text",e.placeholder="Filter",e.className="w-full p-2 border border-gray-300 rounded-lg",e.required=!0,a&&(e.value=a);const t=document.createElement("button");t.type="button",t.innerText="X",t.className="bg-red-500 text-white py-2 px-4 rounded-lg ml-1 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400",t.addEventListener("click",function(){o.remove()}),o.appendChild(e),o.appendChild(t),document.getElementById("specificationInputs").appendChild(o)},u=phpIsSubcategory;y();u&&(f(),d(),document.getElementById("add-inputs-btn").addEventListener("click",function(a){a.preventDefault(),d()}));
