import{g as I,s as o,m as f}from"./utils-CTGP1-Zk.js";const _=()=>{var a,t;const l=document.getElementById("filters-sidebar-wrapper");(a=document.getElementById("filters-button"))==null||a.addEventListener("click",()=>{console.log("clicky"),l.classList.contains("hidden")?l.classList.replace("hidden","flex"):l.classList.replace("flex","hidden")}),(t=document.getElementById("filter-overlay"))==null||t.addEventListener("click",()=>{l.classList.replace("flex","hidden")})},y=()=>{const l=O(z(),h,Number(b),Number(x));k(l)},F=(l,a)=>{let t;console.log(window.innerWidth),window.innerWidth<=640?t=document.getElementById("filters-sidebar"):t=document.getElementById("filters-lg"),l.forEach(s=>{if(s.filterChildren.length){const n=document.createElement("fieldset");n.className=" rounded-md  py-1  text-sm border-b-2 border-gray-300 filterset";const c=document.createElement("legend");c.textContent=s.filterName,c.className="px-2 py-1 text-base font-semibold -top-4 w-full border-gray-300",n.appendChild(c),s.filterChildren.forEach(d=>{const m=document.createElement("label");m.className="flex items-center mb-2 ";const e=document.createElement("input");e.type="checkbox",e.name=s.filterName,e.value=d.value,e.className="form-checkbox text-blue-500 h-4 w-4 translate-y-[1px] mr-2 ml-5",e.addEventListener("change",function(i){this.checked&&i.target.parentElement.parentElement.querySelectorAll("input").forEach(g=>{g!==this&&(g.checked=!1)}),y()});const r=`${d.value} <span class="ml-1 inline-block text-gray-400">(${d.productCount})</span>`;m.appendChild(e),m.insertAdjacentHTML("beforeend",r),n.appendChild(m)}),t.appendChild(n)}})},z=()=>{const l=document.querySelectorAll(".filterset");console.log(l);const a=[];return l.forEach(t=>{var c;const s=(c=t.querySelector("legend"))==null?void 0:c.innerText;console.log(JSON.stringify(s));const n=t.querySelector("label input:checked");console.log(n),s&&n&&a.push({specName:s,specValue:n.value})}),a},A=l=>{const a=document.getElementById("sort-by").value;a!="unsorted"&&l.sort((t,s)=>{const n=t.discounted_price??t.price,c=s.discounted_price??s.price;switch(a){case"highest":return c-n;case"lowest":return n-c;case"newest":return new Date(t.created_at).getTime()-new Date(s.created_at).getTime()}})},O=(l,a,t,s)=>{const n=a.filter(c=>{const d=c.discounted_price??c.price;return t||(t=0),s||(s=1e7),d<t||d>s?!1:(console.log("spec is",JSON.parse(c.specifications)),console.log("filters are ",l),l.every(e=>{const r=JSON.parse(c.specifications).some(i=>i.specName==e.specName&&i.specValue==e.specValue);return console.log("result is ",r),JSON.parse(c.specifications).some(i=>i.specName==e.specName&&i.specValue==e.specValue)}))});return A(n),n};function k(l){var d,m;document.getElementById("products-wrapper")&&((d=document.getElementById("products-wrapper"))==null||d.remove());const a=document.createElement("section");w?a.className="flex flex-col p-1":a.className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 p-1 pr-0",a.id="products-wrapper";let t;const s=localStorage.getItem("securitySystem")?JSON.parse(localStorage.getItem("securitySystem")):{recorder:[],cameras:[],PDU:[],cables:[],monitor:[],hdd:[],accessories:[]};if(w)switch(P.name){case o.recorderName:t=o.filterRecorders(f.mapRecorders(l),s);break;case o.cameraName:t=o.filterCameras(f.mapCameras(l),s);break;case o.cableName:t=o.filterCables(f.mapCables(l),s);break;default:t=o.noFilters(l,s);break}const n=phpFileToken,c=phpFileUrl;t?(console.log(t),t.sort((e,r)=>+r.compatibility-+e.compatibility),console.log(t),console.log(t),t.forEach(e=>{let r="",i=0;JSON.parse(e.item.specifications).forEach(u=>{B.includes(u.specName)&&(i%2===0?r+=`<div class="mb-1">${u.specName}: <span class="font-medium">${u.specValue}</span></div>`:r+=`<div class="mb-1">${u.specName}: <span class="font-medium">${u.specValue}</span></div>`,i++)});let p=null;e.item.discounted_price&&(p=Math.round((1-e.item.discounted_price/e.item.price)*100));function v(u){switch(u){case o.recorderName:return"recorder";case o.cameraName:return"cameras";case o.PDUName:return"PDU";case o.switchesName:return"PDU";case o.cableName:return"cables";case o.monitorName:return"monitor";case o.accName:return"accessories";case o.hddName:return"hdd"}}const g=e.compatibility?"":"disabled",E=e.item.discounted_price?`
            <div class="ml-auto my-auto mx-auto text-lg translate-y-1">
                <div class="z-10   text-center my-auto text-blue-500 ml-auto">${e.item.discounted_price.toLocaleString()} EGP </div>
                <div class="z-10   text-center text-gray-400 line-through mb-2">${e.item.price.toLocaleString()} EGP </div>
            </div>`:`<div class="ml-auto my-auto mx-auto text-lg text-blue-500">${e.item.price.toLocaleString()} EGP </div>`,L=`
            <div class="lg:w-full w-11/12 mx-auto mb-2 flex lg:block border-y-[1px] border-x-[1px] border-gray-200  p-1 flex-shrink-0" id="b02" href="/product/${e.item.id}">
                <div class="relative mx-auto flex flex-col lg:flex-row w-full lg:w-auto h-full rounded-md p-2 ">
                    ${p?`<div class="z-20 text-xs m-1 absolute top-0 rounded-md px-[4px] py-1 bg-blue-400 text-white text-center font-medium">${p}% OFF</div>`:""}
                    <div class="flex mx-auto  lg:mx-0">
                        <img  class="object-contain rounded -translate-y-0 h-36 my-auto w-36 lg:ml-4 lg:w-36 mr-4" src="${c}/file/connect-store/product/${e.item.img_id}/0?Authorization=${n}&b2ContentDisposition=attachment" />
                            <div class="block lg:hidden text-lg my-auto">${E}</div>
                    </div>
                    <div class="flex flex-col lg:mx-0 mx-auto max-w-[22rem]  w-full justify-between ">
                        <div class="z-10 text-gray-800  text-lg px-1 line-clamp-2 mb-4 lg:text-left ">${e.item.name}</div>
                        <div class="grid grid-cols-2 mb-4  lg:w-full lg:-translate-y-3 lg:max-w-full lg:mx-2 lg:mb-0">
                            ${r}
                        </div>
                        <div class="text-red-600 line-clamp-2 w-[20rem] lg:w-auto">${e.compatibility?"":e.message}</div>
                    </div>
                    <div class="hidden lg:block lg:my-auto lg:mr-4 lg:ml-auto">${E}</div>
                    <button class=" rounded-xl  p-2 text-white  text-center mx-auto lg:mx-0 my-auto ${e.compatibility?"bg-blue-600":"bg-blue-200"}   h-auto w-40 selectComponentBtn" ${g} data-type="${v(e.item.subcategory.name)}" id="${e.item.id}">Select Component</button>
     
                </div>
                
            </div>
        `;console.log("err"),a.insertAdjacentHTML("beforeend",L)})):l.forEach(e=>{let r=null;e.discounted_price&&(r=Math.round((1-e.discounted_price/e.price)*100));const i=`
                <a class="scroll-img w-full  border-t-[1px] border-r-[1px] border-gray-200  p-1 flex-shrink-0" id="b02" href="/product/${e.id}">
                    <div class="relative flex flex-col h-full rounded-md">
                        ${r?`<div class="z-20 text-xs m-1 absolute top-0 rounded-md px-[4px] py-1 bg-blue-400 text-white text-center font-medium">${r}% OFF</div>`:""}
                        <img  class="object-contain rounded -translate-y-0 h-52" src="${c}/file/connect-store/product/${e.img_id}/0?Authorization=${n}&b2ContentDisposition=attachment" />
                        <div class="z-10 text-gray-800 mx-auto text-sm text-center px-1 line-clamp-2">${e.name}</div>
                        ${e.discounted_price?`<div class="z-10 mx-auto text-sm text-center mt-auto text-blue-500">${e.discounted_price.toLocaleString()} EGP </div>
                            <div class="z-10 mx-auto text-sm text-center text-gray-400 line-through mb-2">${e.price.toLocaleString()} EGP </div>`:`<div class="z-10 mx-auto text-sm text-center mt-1 text-blue-500 mb-auto">${e.price.toLocaleString()} EGP </div>`}
                    </div>
                </a>
            `;a.insertAdjacentHTML("beforeend",i)}),(m=document.getElementById("main-content"))==null||m.append(a),console.log("hm1"),console.log(document.querySelectorAll(".selectComponentBtn")),document.querySelectorAll(".selectComponentBtn").forEach(e=>{console.log("hmm"),e.addEventListener("click",r=>{r.target.dataset.type=="cameras"||r.target.dataset.type=="cables"||r.target.dataset.type=="accessories"?s[r.target.dataset.type].push(t.find(i=>i.item.id==r.target.id).item):s[r.target.dataset.type]=[t.find(i=>i.item.id==r.target.id).item],console.log(s),localStorage.setItem("securitySystem",JSON.stringify(s)),window.location.href="/builder"})})}function C(l){var n,c;const a=l.target,t=Number(((n=a.parentElement)==null?void 0:n.querySelector("#min-price")).value),s=Number(((c=a.parentElement)==null?void 0:c.querySelector("#max-price")).value);t?b=t:b=0,s?x=s:x=999999,y()}const P=phpSubcategory,B=P?JSON.parse(phpSubcategory.specifications):["Brand"],h=phpProducts,w=phpBuilding;let b=0,x=9999999;_();k(h);const D=I(B||["Brand"],h);F(D);var N;(N=document.getElementById("set-price"))==null||N.addEventListener("click",C);var S;(S=document.getElementById("set-price-lg"))==null||S.addEventListener("click",C);var $;($=document.getElementById("sort-by"))==null||$.addEventListener("change",y);
