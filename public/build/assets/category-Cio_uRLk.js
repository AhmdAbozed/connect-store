import{g as B,s as o,m as g}from"./utils-B3iq3xPc.js";const L=()=>{var i,t;const l=document.getElementById("filters-sidebar-wrapper");(i=document.getElementById("filters-button"))==null||i.addEventListener("click",()=>{console.log("clicky"),l.classList.contains("hidden")?l.classList.replace("hidden","flex"):l.classList.replace("flex","hidden")}),(t=document.getElementById("filter-overlay"))==null||t.addEventListener("click",()=>{l.classList.replace("flex","hidden")})},x=()=>{const l=D(F(),y,Number(f),Number(b));N(l)},_=(l,i)=>{let t;console.log(window.innerWidth),window.innerWidth<=640?t=document.getElementById("filters-sidebar"):t=document.getElementById("filters-lg"),l.forEach(s=>{if(s.filterChildren.length){const a=document.createElement("fieldset");a.className=" rounded-md  py-1  text-sm border-b-2 border-gray-300 filterset";const r=document.createElement("legend");r.textContent=s.filterName,r.className="px-2 py-1 text-base font-semibold -top-4 w-full border-gray-300",a.appendChild(r),s.filterChildren.forEach(d=>{const m=document.createElement("label");m.className="flex items-center mb-2 ";const e=document.createElement("input");e.type="checkbox",e.name=s.filterName,e.value=d.value,e.className="form-checkbox text-blue-500 h-4 w-4 translate-y-[1px] mr-2 ml-5",e.addEventListener("change",function(n){this.checked&&n.target.parentElement.parentElement.querySelectorAll("input").forEach(p=>{p!==this&&(p.checked=!1)}),x()});const c=`${d.value} <span class="ml-1 inline-block text-gray-400">(${d.productCount})</span>`;m.appendChild(e),m.insertAdjacentHTML("beforeend",c),a.appendChild(m)}),t.appendChild(a)}})},F=()=>{const l=document.querySelectorAll(".filterset");console.log(l);const i=[];return l.forEach(t=>{var r;const s=(r=t.querySelector("legend"))==null?void 0:r.innerText;console.log(JSON.stringify(s));const a=t.querySelector("label input:checked");console.log(a),s&&a&&i.push({specName:s,specValue:a.value})}),i},z=l=>{const i=document.getElementById("sort-by").value;i!="unsorted"&&l.sort((t,s)=>{const a=t.discounted_price??t.price,r=s.discounted_price??s.price;switch(i){case"highest":return r-a;case"lowest":return a-r;case"newest":return new Date(t.created_at).getTime()-new Date(s.created_at).getTime()}})},D=(l,i,t,s)=>{const a=i.filter(r=>{const d=r.discounted_price??r.price;return t||(t=0),s||(s=1e7),d<t||d>s?!1:(console.log("spec is",JSON.parse(r.specifications)),console.log("filters are ",l),l.every(e=>{const c=JSON.parse(r.specifications).some(n=>n.specName==e.specName&&n.specValue==e.specValue);return console.log("result is ",c),JSON.parse(r.specifications).some(n=>n.specName==e.specName&&n.specValue==e.specValue)}))});return z(a),a};function N(l){var d,m;document.getElementById("products-wrapper")&&((d=document.getElementById("products-wrapper"))==null||d.remove());const i=document.createElement("section");E?i.className="flex flex-col p-1":i.className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 p-1 pr-0",i.id="products-wrapper";let t=[];const s=localStorage.getItem("securitySystem")?JSON.parse(localStorage.getItem("securitySystem")):{recorder:[],cameras:[],cables:[],PDU:[]};if(E)switch(C.id){case o.recordersId:t=o.filterRecorders(g.mapRecorders(l),s);break;case o.camerasId:t=o.filterCameras(g.mapCameras(l),s);break;case o.PDUsId:t=o.filterPDUs(g.mapPDUs(l),s);break;case o.CablesId:t=o.filterCables(g.mapCables(l),s);break}console.log(t);const a=phpFileToken,r=phpFileUrl;t.length?(console.log(t),t.sort((e,c)=>+c.compatibility-+e.compatibility),console.log(t),console.log(t),t.forEach(e=>{let c="";JSON.parse(e.item.specifications).forEach((u,I)=>{I%2===0?c+=`<div class="mb-1">${u.specName}: <span class="font-medium">${u.specValue}</span></div>`:c+=`<div class="mb-1 text-right">${u.specName}: <span class="font-medium">${u.specValue}</span></div>`});let n=null;e.item.discounted_price&&(n=Math.round((1-e.item.discounted_price/e.item.price)*100));function h(u){switch(u){case o.recordersId:return"recorder";case o.camerasId:return"cameras";case o.PDUsId:return"PDU";case o.CablesId:return"cables"}}const v=e.compatibility?"":"disabled",p=e.item.discounted_price?`
            <div class="ml-auto my-auto mx-auto text-lg translate-y-1">
                <div class="z-10   text-center my-auto text-blue-500 ml-auto">${e.item.discounted_price.toLocaleString()} EGP </div>
                <div class="z-10   text-center text-gray-400 line-through mb-2">${e.item.price.toLocaleString()} EGP </div>
            </div>`:`<div class="ml-auto my-auto mx-auto text-lg text-blue-500">${e.item.price.toLocaleString()} EGP </div>`,P=`
            <div class="sm:w-full w-11/12 mx-auto mb-2 flex sm:block border-y-[1px] border-x-[1px] border-gray-200  p-1 flex-shrink-0" id="b02" href="/product/${e.item.id}">
                <div class="relative mx-auto flex flex-col sm:flex-row h-full rounded-md p-2 ">
                    ${n?`<div class="z-20 text-xs m-1 absolute top-0 rounded-md px-[4px] py-1 bg-blue-400 text-white text-center font-medium">${n}% OFF</div>`:""}
                    <div class="flex mx-auto  sm:mx-0">
                        <img  class="object-contain rounded -translate-y-0 h-36 my-auto w-36 lg:ml-4 sm:w-36 mr-4" src="${r}/file/connect-store/product/${e.item.img_id}/0?Authorization=${a}&b2ContentDisposition=attachment" />
                            <div class="block sm:hidden text-lg my-auto">${p}</div>
                    </div>
                    <div class="flex flex-col sm:max-w-[12rem] lg:max-w-[20rem] w-full justify-between ">
                        <div class="z-10 text-gray-800  text-lg px-1 line-clamp-2 mb-4 sm:mb-0">${e.item.name}</div>
                        <div class="grid grid-cols-2 mb-4  sm:mb-0">
                            ${c}
                        </div>
                        <div class="text-red-600 line-clamp-2 w-[20rem] sm:w-auto">${e.compatibility?"":e.message}</div>
                    </div>
                    <div class="hidden sm:block sm:my-auto sm:mr-4 sm:ml-auto">${p}</div>
                    <button class=" rounded-xl  p-2 text-white  text-center mx-auto sm:mx-0 my-auto ${e.compatibility?"bg-blue-600":"bg-blue-200"} sm:h-9 lg:max-h-12 lg:h-auto w-40 sm:w-20 lg:w-40 selectComponentBtn" ${v} data-type="${h(e.item.subcategory.id)}" id="${e.item.id}">Select Component</button>
     
                </div>
                
            </div>
        `;console.log("err"),i.insertAdjacentHTML("beforeend",P)})):l.forEach(e=>{let c=null;e.discounted_price&&(c=Math.round((1-e.discounted_price/e.price)*100));const n=`
                <a class="scroll-img w-full  border-t-[1px] border-r-[1px] border-gray-200  p-1 flex-shrink-0" id="b02" href="/product/${e.id}">
                    <div class="relative flex flex-col h-full rounded-md">
                        ${c?`<div class="z-20 text-xs m-1 absolute top-0 rounded-md px-[4px] py-1 bg-blue-400 text-white text-center font-medium">${c}% OFF</div>`:""}
                        <img  class="object-contain rounded -translate-y-0 h-52" src="${r}/file/connect-store/product/${e.img_id}/0?Authorization=${a}&b2ContentDisposition=attachment" />
                        <div class="z-10 text-gray-800 mx-auto text-sm text-center px-1 line-clamp-2">${e.name}</div>
                        ${e.discounted_price?`<div class="z-10 mx-auto text-sm text-center mt-auto text-blue-500">${e.discounted_price.toLocaleString()} EGP </div>
                            <div class="z-10 mx-auto text-sm text-center text-gray-400 line-through mb-2">${e.price.toLocaleString()} EGP </div>`:`<div class="z-10 mx-auto text-sm text-center mt-1 text-blue-500 mb-auto">${e.price.toLocaleString()} EGP </div>`}
                    </div>
                </a>
            `;i.insertAdjacentHTML("beforeend",n)}),(m=document.getElementById("main-content"))==null||m.append(i),document.querySelectorAll(".selectComponentBtn").forEach(e=>{e.addEventListener("click",c=>{c.target.dataset.type=="cameras"||c.target.dataset.type=="cables"?s[c.target.dataset.type].push(t.find(n=>n.item.id==c.target.id).item):s[c.target.dataset.type]=[t.find(n=>n.item.id==c.target.id).item],console.log(s),localStorage.setItem("securitySystem",JSON.stringify(s)),window.location.href="/builder"})})}function k(l){var a,r;const i=l.target,t=Number(((a=i.parentElement)==null?void 0:a.querySelector("#min-price")).value),s=Number(((r=i.parentElement)==null?void 0:r.querySelector("#max-price")).value);t?f=t:f=0,s?b=s:b=9999999,x()}const C=phpSubcategory,O=C?JSON.parse(phpSubcategory.specifications):["Brand"],y=phpProducts,E=phpBuilding;let f=0,b=9999999;L();N(y);const A=B(O||["Brand"],y);_(A);var w;(w=document.getElementById("set-price"))==null||w.addEventListener("click",k);var S;(S=document.getElementById("set-price-lg"))==null||S.addEventListener("click",k);var $;($=document.getElementById("sort-by"))==null||$.addEventListener("change",x);
